language: cpp
dist: trusty
sudo: required

# sadly Qt 5.8 ppa not in travis whitelist so need sudo https://github.com/travis-ci/apt-source-whitelist/issues/357
matrix:
- os:linux
  env: QBS_PROFILE=gcc
  before_install:
    - sudo add-apt-repository ppa:beineri/opt-qt58-trusty && sudo apt-get update
    - sudo apt-get install gcc-5 g++-5 tree qt58qbs
    - ./scripts/travis-checkout.sh

  after_install:
    - mkdir -p ~/bin && ln -fs /usr/bin/gcc-5 ~/bin/gcc && ln -fs /usr/bin/g++-5 ~/bin/g++
    - gcc --version
    - g++ --version
    - qbs setup-toolchains --detect
- os:osx
  env: QBS_PROFILE=clang
  before_install:
    - brew update
    - brew install qbs
  after_install:
    - qbs setup-toolchains --detect

script:
  - qbs install profile:${QBS_PROFILE} release qbs.installRoot:./dist
  - tree ./dist
